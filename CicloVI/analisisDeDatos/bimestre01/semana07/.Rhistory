contenidoR = contenidoR %>%
mutate(clima = clima)
# Seleccionamos las columnas que nescecitemos
contenidoR = contenidoR %>%
select(TemperaturaActual = main.temp,
SensacionTermica = main.feels_like,
TemperaturaMinima = main.temp_min,
TemperaturaMaxima = main.temp_max,
HumedadRelativa =main.humidity,
VelocidadViento = wind.speed,
Clima = clima
)
str(contenidoR)
library(httr)
library(RMySQL)
library("httr")
############################
# SEMANA 6
# Extraccion mediante API'S
############################
install.packages("httr")
library("httr")
library("jsonlite")
library("dplyr")
url_base = "https://api.worldbank.org/v2/country"
region = "CLA"
nivelIngresos = "UMC"
formato = "json"
cantObeservaciones = 1000
url = paste0(url_base,
"?region=", region,
"&incomeLevel=", nivelIngresos,
"&format=", formato,
"&per_page=", cantObeservaciones)
respuesta = GET(url)
# Otra forma de llamar
parametros = list(region = "CLA",
nivelIngresos = "UMC",
formato = "json",
cantObeservaciones = 1000)
respuesta = GET(url_base, query = parametros)
class(respuesta) # Verifica que tipo creo
status_code(respuesta) # Verificamos el estado
# Guardamos el contenido desde content que se creo en respuesta en formato JSON
contenido_json = content(respuesta, "text")
# Convertir a JSON
contenidoR = fromJSON(contenido_json, flatten = TRUE)
status_code(respuesta) # Verificamos el estado
url_base = "https://api.worldbank.org/v2/country"
region = "CLA"
nivelIngresos = "UMC"
formato = "json"
cantObeservaciones = 1000
url = paste0(url_base,
"?region=", region,
"&incomeLevel=", nivelIngresos,
"&format=", formato,
"&per_page=", cantObeservaciones)
respuesta = GET(url)
install.packages("httr")
library("httr")
library("jsonlite")
library("dplyr")
url_base = "https://api.worldbank.org/v2/country"
region = "CLA"
nivelIngresos = "UMC"
formato = "json"
cantObeservaciones = 1000
url = paste0(url_base,
"?region=", region,
"&incomeLevel=", nivelIngresos,
"&format=", formato,
"&per_page=", cantObeservaciones)
respuesta = GET(url)
# Otra forma de llamar
parametros = list(region = "CLA",
nivelIngresos = "UMC",
formato = "json",
cantObeservaciones = 1000)
respuesta = GET(url_base, query = parametros)
class(respuesta) # Verifica que tipo creo
status_code(respuesta) # Verificamos el estado
# Guardamos el contenido desde content que se creo en respuesta en formato JSON
contenido_json = content(respuesta, "text", encoding = "UTF-8")
# Convertir a JSON
contenidoR = fromJSON(contenido_json, flatten = TRUE)
url_base = "https://api.worldbank.org/v2/country"
region = "CLA"
nivelIngresos = "UMC"
formato = "json"
cantObeservaciones = 1000
url = paste0(url_base,
"?region=", region,
"&incomeLevel=", nivelIngresos,
"&format=", formato,
"&per_page=", cantObeservaciones)
respuesta = GET(url)
# Otra forma de llamar
parametros = list(
region = "CLA",
incomeLevel = "UMC",
format = "json",
per_page = 1000
)
respuesta = GET(url_base, query = parametros)
class(respuesta) # Verifica que tipo creo
status_code(respuesta) # Verificamos el estado
# Guardamos el contenido desde content que se creo en respuesta en formato JSON
contenido_json = content(respuesta, "text", encoding = "UTF-8")
# Convertir a JSON
contenidoR = fromJSON(contenido_json, flatten = TRUE)
paises = contenidoR[[2]]
paises = paises %>%
select(
id,
iso2Code,
region = region.value,
capital = capitalCity,
nivel_ingreso = incomeLevel.value,
tipo_financiamiento = lendingType.value,
longitud = longitude,
latitud = latitude)
str(paises)
paises = paises %>%
mutate(longitud = as.numeric(longitud),
latitud = as.numeric(latitud))
library("httr")
library(RMySQL)
library("jsonlite")
library("dplyr")
url_base = "https://api.openweathermap.org/data/2.5/forecast"
latitud = -3.98661
longitud = -79.35763
apikey = "4afd29be646ee3c7027bea84dc25ce84"
url = paste0(url_base,
"?lat=", latitud,
"&lon=", longitud,
"&appid=", apikey)
respuesta = GET(url)
class(respuesta)
status_code(respuesta) # Verificamos el estado
# Guardamos el contenido desde content que se creo en respuesta en formato JSON
contenido_json = content(respuesta, "text")
contenidoR = fromJSON(contenido_json, flatten = TRUE)
class(contenidoR)
View(contenidoR)
# Obtenemos el contenido de la posicion 4
contenidoR = contenidoR[[4]]
install.packages("httr")
library(RMySQL)
library("jsonlite")
library("dplyr")
url_base = "https://api.openweathermap.org/data/2.5/forecast"
latitud = -3.98661
longitud = -79.35763
apikey = "4afd29be646ee3c7027bea84dc25ce84"
url = paste0(url_base,
"?lat=", latitud,
"&lon=", longitud,
"&appid=", apikey)
respuesta = GET(url)
contenidoR = fromJSON(contenido_json, flatten = TRUE)
class(contenidoR)
# Obtenemos el contenido de la posicion 4
contenidoR = contenidoR[[4]]
str(contenidoR)
# LIMPIEZA DE DATOS
datos_f = contenidoR %>%
mutate(rain.3h = ifelse(is.na(rain.3h), 0, rain.3h))
View(datos_f)
View(datos_f[[2]][[23]])
# Sacamos la descripcion dentro del data.frame de la variable weather
class(datos_f$weather)
datos_f = datos_f %>%
mutate(tipoClima = sapply(weather, function(df) df$description))
datos_f = datos_f %>%
select(dt_txt, main.temp_min, main.temp_max, rain.3h, tipoClima)
datos_f
str(datos_f)
datos_f = datos_f %>%
mutate(hora = as.POSIXct(hora, format = "%Y-%M-%D %H-%S"))
datos_f = datos_f %>%
mutate(hora = as.POSIXct(hora, format = "%Y-%M-%D %H-%S"))
datos_f = datos_f %>%
mutate(hora = as.POSIXct(dt_txt, format = "%Y-%M-%D %H-%S"))
datos_f
str(datos_f)
# ENRIQUECIMIENTO DE DATOS
# Agregar la temperatura promedio
datos_f = datos_f %>%
mutate(tempPromedio = (sum(main.temp_min) + sum(main.temp_max) / 2))
datos_f
mutate(tempPromedio = (sum(main.temp_min + main.temp_max) / 2)
datos_f
# ENRIQUECIMIENTO DE DATOS
# Agregar la temperatura promedio
datos_f = datos_f %>%
mutate(tempPromedio = (main.temp_min + main.temp_max) / 2)
datos_f
datos_f = datos_f %>%
mutate(hora = as.POSIXct(dt_txt, format = "%Y-%m-%d %H:%M:%S"))
datos_f
install.packages("tydyr")
library(tydyr)
library("tydyr")
install.packages("tydyr")
install.packages("tidyr")
library("tidyr")
library("dplyr")
getwd()
setwd("/Users/oliversaraguro/Desktop/CicloVI/analisisDeDatos/bimestre01/semana07")
getwd()
datos -> read.csv("UCL_Finals.csv")
datos = read.csv("UCL_Finals.csv")
datos = read.csv("UCL_Finals.csv", set = ",", quote = '"')
datos = read.csv("UCL_Finals.csv", sep = ",", quote = '"')
lib
library("tidyr")
library("dplyr")
getwd()
setwd("/Users/oliversaraguro/Desktop/CicloVI/analisisDeDatos/bimestre01/semana07")
datos = read.csv("UCL_Finals.csv", sep = ",", quote = '"')
datos
View(datos)
str(datos)
name(datos)
names(datos)
# Renombrar variables (LIMPIEZA)
df = datos %>%
rename(temporada = Season,
paisGanador = Country,
equipoGanador = Winners,
resultado = Score,
equipoPerdedor = Runners.up,
paisPerdedor = Country.1,
lugar = Venue,
asistencia = Attend.ance,
notas = Notes)
names(df)
View(df)
# Correguir inconsitencias (LIMPIEZA)
df = df %>%
mutate(asistencia = ifelse(asistencia == "NoS", 0, asistencia))
View(df)
df %>%
group_by(temporada)
df %>%
group_by(temporada) %>%
count()
temp = df %>%
group_by(temporada) %>%
count()
View(temp)
temp = df %>%
group_by(temporada) %>%
filter(count() > 1)
df %>%
group_by(temporada) %>%
filter(summarise(t = n) > 1)
df %>%
group_by(temporada) %>%
summarise(t = n) %>%
filter(t > 1)
df %>%
group_by(temporada) %>%
summarise(t = n()) %>%
filter(t > 1)
df %>%
distinct(temporada)
df %>%
distinct(temporada, .keep_all = TRUE)
df %>%
mutate(id = row_number())
df %>%
mutate(id = row_number()) %>%
arrange(temporada, desc(id))
df %>%
mutate(id = row_number()) %>%
arrange(temporada, desc(id)) %>%
distinct(temporada, .keep_all = TRUE)
df = df %>%
mutate(id = row_number()) %>%
arrange(temporada, desc(id)) %>%
distinct(temporada, .keep_all = TRUE)
names
# Separar valores compuestos (TRANSFORMACION)
df %>%
separate(col = resultado,
c("golesGnador", "golesPerdedor"),
sep = ",")
# Separar valores compuestos (TRANSFORMACION)
df %>%
separate(col = resultado,
c("golesGnador", "golesPerdedor"),
sep = "–")
df %>%
separate(col = lugar,
c("finalEstadio", "finalCiudad", "finalPais"),
sep = ", ")
df = df %>%
separate(col = lugar,
c("finalEstadio", "finalCiudad", "finalPais"),
sep = ", ")
# Separar valores compuestos (TRANSFORMACION)
df = df %>%
separate(col = resultado,
c("golesGnador", "golesPerdedor"),
sep = "–")
df = df %>%
separate(col = lugar,
c("finalEstadio", "finalCiudad", "finalPais"),
sep = ", ")
# Renombrar variables (LIMPIEZA)
df = datos %>%
rename(temporada = Season,
paisGanador = Country,
equipoGanador = Winners,
resultado = Score,
equipoPerdedor = Runners.up,
paisPerdedor = Country.1,
lugar = Venue,
asistencia = Attend.ance,
notas = Notes)
names(df)
# Correguir inconsitencias (LIMPIEZA)
df = df %>%
mutate(asistencia = ifelse(asistencia == "NoS", 0, asistencia))
# Eliminar duplicados (LIMPIEZA)
df %>%
group_by(temporada) %>%
summarise(t = n()) %>%
filter(t > 1)
df %>%
distinct(temporada, .keep_all = TRUE)
df = df %>%
mutate(id = row_number()) %>%
arrange(temporada, desc(id)) %>%
distinct(temporada, .keep_all = TRUE)
# Separar valores compuestos (TRANSFORMACION)
df = df %>%
separate(col = resultado,
c("golesGnador", "golesPerdedor"),
sep = "–")
df = df %>%
separate(col = lugar,
c("finalEstadio", "finalCiudad", "finalPais"),
sep = ",")
View(df)
# Eliminar espacios en blanco
df = df %>%
mutate(finalCiudad = trimws(finalCiudad),
finalPais = trimws(finalPais))
str(df)
# Convertir tipos de datos
df = df %>%
mutate(golesGnador = as.int(golesGnador))
# Convertir tipos de datos
df = df %>%
mutate(golesGnador = as.integer(golesGnador),
golesPerdedor = as.integer(golesPerdedor)
asistencia = as.integer(asistencia))
# Convertir tipos de datos
df = df %>%
mutate(golesGnador = as.integer(golesGnador),
golesPerdedor = as.integer(golesPerdedor),
asistencia = as.integer(asistencia))
df
asistencia = as.integer(gsub(",","", asistencia))
# Convertir tipos de datos
df = df %>%
mutate(golesGnador = as.integer(golesGnador),
golesPerdedor = as.integer(golesPerdedor),
asistencia = as.integer(gsub(",","", asistencia)))
df
datos = read.csv("UCL_Finals.csv", sep = ",", quote = '"')
str(datos)
names(datos)
# Renombrar variables (LIMPIEZA)
df = datos %>%
rename(temporada = Season,
paisGanador = Country,
equipoGanador = Winners,
resultado = Score,
equipoPerdedor = Runners.up,
paisPerdedor = Country.1,
lugar = Venue,
asistencia = Attend.ance,
notas = Notes)
names(df)
# Correguir inconsitencias (LIMPIEZA)
df = df %>%
mutate(asistencia = ifelse(asistencia == "NoS", 0, asistencia))
# Eliminar duplicados (LIMPIEZA)
df %>%
group_by(temporada) %>%
summarise(t = n()) %>%
filter(t > 1)
df %>%
distinct(temporada, .keep_all = TRUE)
df = df %>%
mutate(id = row_number()) %>%
arrange(temporada, desc(id)) %>%
distinct(temporada, .keep_all = TRUE)
# Separar valores compuestos (TRANSFORMACION)
df = df %>%
separate(col = resultado,
c("golesGnador", "golesPerdedor"),
sep = "–")
df = df %>%
separate(col = lugar,
c("finalEstadio", "finalCiudad", "finalPais"),
sep = ",")
# Eliminar espacios en blanco
df = df %>%
mutate(finalCiudad = trimws(finalCiudad),
finalPais = trimws(finalPais))
str(df)
# Convertir tipos de datos
df = df %>%
mutate(golesGnador = as.integer(golesGnador),
golesPerdedor = as.integer(golesPerdedor),
asistencia = as.integer(gsub(",","", asistencia)))
str(df)
# Agregar campos derivados (ENRIQUECIMIENTO)
df %>%
mutate(diferenciaGoles = golesGnador - golesPerdedor)
# Agregar campos derivados (ENRIQUECIMIENTO)
df = df %>%
mutate(diferenciaGoles = golesGnador - golesPerdedor)
# Agregar campos derivados (ENRIQUECIMIENTO)
df = df %>%
mutate(diferenciaGoles = golesGnador - golesPerdedor,
campos = paste0(equipoGanador, " (", paisGanador, " )"))
# Agregar campos derivados (ENRIQUECIMIENTO)
df = df %>%
mutate(diferenciaGoles = golesGnador - golesPerdedor,
campos = paste0(equipoGanador, " (", paisGanador, ")"))
str(df)
# Agregar campos derivados (ENRIQUECIMIENTO)
df = df %>%
rename(golesGanador = golesGnador) %>%
mutate(diferenciaGoles = golesGnador - golesPerdedor,
campeon = paste0(equipoGanador, " (", paisGanador, ")"))
# Agregar campos derivados (ENRIQUECIMIENTO)
df = df %>%
rename(golesGanador = golesGnador) %>%
mutate(diferenciaGoles = golesGanador - golesPerdedor,
campeon = paste0(equipoGanador, " (", paisGanador, ")"))
df$notas
df %>%
distinct(notas)
df %>%
mutate(tipoDefinicion = case_when(
grepl("extra", notas) - "Tiempo Extra",
grepl("replay", notas) - "Repetición",
grepl("panalty", notas) - "Via Penales",
TRUE = "Tiempo Regular"
df %>%
mutate(tipoDefinicion = case_when(
grepl("extra", notas) - "Tiempo Extra",
grepl("replay", notas) - "Repetición",
grepl("panalty", notas) - "Via Penales",
TRUE - "Tiempo Regular"
))
df %>%
mutate(tipoDefinicion = case_when(
grepl("extra", notas) ~ "Tiempo Extra",
grepl("replay", notas) ~ "Repetición",
grepl("panalty", notas) ~ "Via Penales",
TRUE ~ "Tiempo Regular"
))
df = df %>%
mutate(tipoDefinicion = case_when(
grepl("extra", notas) ~ "Tiempo Extra",
grepl("replay", notas) ~ "Repetición",
grepl("panalty", notas) ~ "Via Penales",
TRUE ~ "Tiempo Regular"
))
df = df %>%
select(-c(notas, id))
df
paises = read.csv("Countries_Europe.csv", sep = ",")
paises
paises = read.csv("Countries_Europe.csv", sep = ",")
View(paises)
paisesEuropa = read.csv("Countries_Europe.csv", sep = ",")
df %>%
inner_join(paisesEuropa, by = finalPais)
df %>%
inner_join(paisesEuropa, by = df$finalPais)
paisesEuropa = read.csv("Countries_Europe.csv", sep = ",")
paisesEuropa
df %>%
inner_join(paisesEuropa, by = join_by(finalPais = Country))
df %>%
inner_join(paisesEuropa, by = join_by(finalPais == Country))
df %>%
left_join(paisesEuropa, by = join_by(finalPais == Country))
df = df %>%
left_join(paisesEuropa, by = join_by(finalPais == Country))
df %>%
mutate(EU = ifelse(EU == NA, N, EU))
df %>%
mutate(EU = ifelse(EU == .isNa, N, EU))
df %>%
mutate(EU = ifelse(EU.isNa, N, EU))
df %>%
mutate(EU = replace_na(EU, "N"))%>%
rename(unionEuropea = EU)
df = df %>%
mutate(EU = replace_na(EU, "N"))%>%
rename(unionEuropea = EU)
